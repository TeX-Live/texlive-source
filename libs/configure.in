dnl configure.in for TeX Live source/libs.
dnl Public domain.
AC_INIT(zlib/zlib.h)

AC_CONFIG_AUX_DIR(../config)
AC_PROG_MAKE_SET
AC_PROG_CC
AC_CANONICAL_SYSTEM
AC_PROG_INSTALL
AC_PROG_MAKE_SET
AC_PROG_LN_S
AC_FUNC_ALLOCA
AC_PROG_RANLIB
AM_MAINTAINER_MODE

sinclude(../texk/kpathsea/withenable.ac)
sinclude(ncurses/withenable.ac)
sinclude(ncurses/ncurses.ac)
sinclude(zlib/withenable.ac)
sinclude(zlib/zlib.ac)
sinclude(libpng/withenable.ac)
sinclude(libpng/libpng.ac)
sinclude(t1lib/withenable.ac)
sinclude(t1lib/t1lib.ac)
sinclude(freetype/withenable.ac)
sinclude(freetype/freetype.ac)
sinclude(freetype2/withenable.ac)
sinclude(freetype2/freetype2.ac)
sinclude(gd/withenable.ac)
sinclude(gd/gd.ac)
sinclude(icu-xetex/withenable.ac)
sinclude(icu-xetex/icu-xetex.ac)
sinclude(teckit/teckit.ac)
sinclude(graphite-engine/withenable.ac)
sinclude(graphite-engine/graphite-engine.ac)

# The following line helps, e.g. for ncurses which properly detects the
# system's terminfo definitions if configured without explicit --prefix.
# ac_configure_args=`echo "$ac_configure_args" | sed 's@--prefix=[[^ ]]*@@'`

if test "x$needs_ncurses" != xno && test "$using_system_ncurses"  != yes; then
  AC_CONFIG_SUBDIRS([ncurses])
fi
if test "x$needs_zlib" != xno && test "$using_system_zlib"  != yes; then
  KPSE_CONFIG_FILES([zlib/Makefile])
fi
if test "x$needs_pnglib" != xno && test "$using_system_pnglib"  != yes; then
  KPSE_CONFIG_FILES([libpng/Makefile])
fi
if test "x$needs_libxpdf" != xno; then
  AC_CONFIG_SUBDIRS([xpdf])
fi
if test "x$needs_libt1" != xno && test "$using_system_t1lib"  != yes; then
  AC_CONFIG_SUBDIRS([t1lib type1])
fi
if test "x$needs_freetype" != xno && test "$using_system_freetype" != yes; then
  AC_CONFIG_SUBDIRS([freetype])
fi
if test "x$needs_freetype2" != xno && test "$using_system_freetype2" != yes; then
  AC_CONFIG_SUBDIRS([freetype2])
fi
if test "x$needs_gd" != xno && test "$using_system_gd" != yes; then
  AC_CONFIG_SUBDIRS([gd])
fi
if test "x$needs_icu" != xno && test "$using_system_icu" != yes; then
  ac_configure_args="$ac_configure_args --enable-static"
  AC_CONFIG_SUBDIRS([icu-xetex])
fi
if test "x$needs_teckit" != xno; then
  AC_CONFIG_SUBDIRS([teckit])
fi
if test "x$needs_graphite" != xno; then
  AC_CONFIG_SUBDIRS([graphite-engine])
fi
if test "x$needs_obsdcompat" != xno; then
  AC_CONFIG_SUBDIRS([obsdcompat])
fi

# create md5 directory  when building outside the srcdir:
if test -d $srcdir/md5; then
  test -d md5 || mkdir md5
fi

AC_OUTPUT
